---
layout: post
title: tcp报文讲起
tags:
- tcp
categories: network
description: tcp报文讲起
---

本文主要介绍tcp报文结构及其作用。

## TCP报文结构
<img src="/assets/img/tcp-data.jpg" width="650"/>

- 序号
  
  本TCP报文所`发送的数据`(即TCP报文的数据段部分)的第一个字节的序号。

- 确认号

  假设A发送给B一个TCP报文，报文的***确认号*** 字段值是101，则表示A期望B下次发送的报文数据序号为101
  (言外之意，B发送的序号为100的报文数据A已经接收到了)。

- 数据偏移
  
  表示TCP报文段的首部长度，4个bit最大表示15，“数据偏移”的单位是“4字节”，所以TCP`首部最多60个字节`，而`固定首部占用20个
  字节`，所以`选项部分最多占用40个字节`。

- 窗口
  
  占2字节。假设A发送给B一个TCP报文，报文的***窗口*** 字段值是50，则表示`从报文首部中的确认号算起，
  A允许B发送50个字节数据量`。窗口值作为接收方让发送方设置其发送窗口的依据。

- 选项
  - `MSS`(Maximum Segement Size) 是一个TCP报文段中的`数据字段的最大长度`，所以MSS并不是整个TCP报文段的最大长度，
    而是“TCP报文段长度 - TCP首部长度”。
    
    值太小，网络利用率就低；
    
    值太大，在IP层传输时就有可能要分解成多个短数据报片。在终点要把收到的各个短数据报片装配成原来的TCP报文段。
    当传输出错时还要进行重传。这些也都会使开销增大。
## 参考
1. [计算机网络 谢希仁]()